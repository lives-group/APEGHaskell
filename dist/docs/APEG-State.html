<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>APEG.State</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/APEG.State.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Leonardo Vieira dos Santos Reis 2018<br />Rodrigo Geraldo Ribeiro 2018<br />Elton M. Cardoso 2018</td></tr><tr><th>License</th><td>GPL-3</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>POSIX</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">APEG.State</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module contains the definition of an APEG state used throughout the interpreter and type-checker.
The abstract data type allows for consulting and updating value and type environments, obtain the
string currently accepted by the recognizer, setting and consulting and transforming the results and
finally manipulation of the input.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:APegTuple">APegTuple</a> a = (<a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a>, <a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a>, <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a>, <a href="APEG-State.html#t:Input" title="APEG.State">Input</a>, <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> a)</li><li class="src short"><span class="keyword">type</span> <a href="#t:Result">Result</a> a = Either [String] a</li><li class="src short"><span class="keyword">type</span> <a href="#t:APegSt">APegSt</a> a = State (<a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a)</li><li class="src short"><span class="keyword">type</span> <a href="#t:VEnv">VEnv</a> = Map String <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TyEnv">TyEnv</a> = Map String (<a href="APEG-AbstractSyntax.html#t:Type" title="APEG.AbstractSyntax">Type</a>, <a href="APEG-State.html#t:TyRuleEnv" title="APEG.State">TyRuleEnv</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:TyRuleEnv">TyRuleEnv</a> = Map String <a href="APEG-AbstractSyntax.html#t:Type" title="APEG.AbstractSyntax">Type</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TraceStr">TraceStr</a> = Maybe String</li><li class="src short"><span class="keyword">type</span> <a href="#t:Input">Input</a> = String</li><li class="src short"><a href="#v:rVal">rVal</a> :: a -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> a</li><li class="src short"><a href="#v:rErr">rErr</a> :: String -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> a</li><li class="src short"><a href="#v:-63-:">(?:)</a> :: Char -&gt; <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a> -&gt; <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a></li><li class="src short"><a href="#v:nullTraceStr">nullTraceStr</a> :: <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a></li><li class="src short"><a href="#v:emptyTraceStr">emptyTraceStr</a> :: <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a></li><li class="src short"><a href="#v:errorTuple">errorTuple</a> :: String -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a</li><li class="src short"><a href="#v:isOkTuple">isOkTuple</a> :: <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; Bool</li><li class="src short"><a href="#v:valEnv">valEnv</a> :: <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a></li><li class="src short"><a href="#v:tyEnv">tyEnv</a> :: <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a></li><li class="src short"><a href="#v:upValEnv">upValEnv</a> :: (<a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a> -&gt; <a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a>) -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a</li><li class="src short"><a href="#v:upTyEnv">upTyEnv</a> :: (<a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a> -&gt; <a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a>) -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a</li><li class="src short"><a href="#v:withResult">withResult</a> :: ([String] -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> b) -&gt; (a -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> b) -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> b</li><li class="src short"><a href="#v:valIsMExpr">valIsMExpr</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; Bool</li><li class="src short"><a href="#v:valIsMPeg">valIsMPeg</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; Bool</li><li class="src short"><a href="#v:strVal">strVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; String</li><li class="src short"><a href="#v:expFromVal">expFromVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; <a href="APEG-AbstractSyntax.html#t:Expr" title="APEG.AbstractSyntax">Expr</a></li><li class="src short"><a href="#v:varNameFromVal">varNameFromVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; <a href="APEG-AbstractSyntax.html#t:Var" title="APEG.AbstractSyntax">Var</a></li><li class="src short"><a href="#v:apegFromVal">apegFromVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; <a href="APEG-AbstractSyntax.html#t:APeg" title="APEG.AbstractSyntax">APeg</a></li><li class="src short"><a href="#v:zeroSt">zeroSt</a> :: <a href="APEG-AbstractSyntax.html#t:ApegGrm" title="APEG.AbstractSyntax">ApegGrm</a> -&gt; String -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> ()</li><li class="src short"><a href="#v:ruleEntry">ruleEntry</a> :: <a href="APEG-AbstractSyntax.html#t:ApegRule" title="APEG.AbstractSyntax">ApegRule</a> -&gt; (<a href="APEG-AbstractSyntax.html#t:NonTerminal" title="APEG.AbstractSyntax">NonTerminal</a>, (<a href="APEG-AbstractSyntax.html#t:Type" title="APEG.AbstractSyntax">Type</a>, <a href="APEG-State.html#t:TyRuleEnv" title="APEG.State">TyRuleEnv</a>))</li><li class="src short"><a href="#v:isOk">isOk</a> :: <a href="APEG-State.html#t:APegSt" title="APEG.State">APegSt</a> () Bool</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:APegTuple" class="def">APegTuple</a> a = (<a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a>, <a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a>, <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a>, <a href="APEG-State.html#t:Input" title="APEG.State">Input</a>, <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> a) <a href="src/APEG.State.html#APegTuple" class="link">Source</a> <a href="#t:APegTuple" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Result" class="def">Result</a> a = Either [String] a <a href="src/APEG.State.html#Result" class="link">Source</a> <a href="#t:Result" class="selflink">#</a></p><div class="doc"><p>The result buit by a parser. Can either be an list of error messages or
 an actual value of some type a.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:APegSt" class="def">APegSt</a> a = State (<a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a) <a href="src/APEG.State.html#APegSt" class="link">Source</a> <a href="#t:APegSt" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:VEnv" class="def">VEnv</a> = Map String <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> <a href="src/APEG.State.html#VEnv" class="link">Source</a> <a href="#t:VEnv" class="selflink">#</a></p><div class="doc"><p>Value environment, a mapping form names to <code>Values</code></p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TyEnv" class="def">TyEnv</a> = Map String (<a href="APEG-AbstractSyntax.html#t:Type" title="APEG.AbstractSyntax">Type</a>, <a href="APEG-State.html#t:TyRuleEnv" title="APEG.State">TyRuleEnv</a>) <a href="src/APEG.State.html#TyEnv" class="link">Source</a> <a href="#t:TyEnv" class="selflink">#</a></p><div class="doc"><p>Type environment, a mapping from names to a non terminal <code><a href="APEG-AbstractSyntax.html#t:Type" title="APEG.AbstractSyntax">Type</a></code> an 
 it's inner enviroment</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TyRuleEnv" class="def">TyRuleEnv</a> = Map String <a href="APEG-AbstractSyntax.html#t:Type" title="APEG.AbstractSyntax">Type</a> <a href="src/APEG.State.html#TyRuleEnv" class="link">Source</a> <a href="#t:TyRuleEnv" class="selflink">#</a></p><div class="doc"><p>Type environment for a rule. Maps varialble names to </p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TraceStr" class="def">TraceStr</a> = Maybe String <a href="src/APEG.State.html#TraceStr" class="link">Source</a> <a href="#t:TraceStr" class="selflink">#</a></p><div class="doc"><p>A TraceStr is a String that may be initialized, an actual string, or may not be initialized,
 a null String. Any operation on null String will result a null String. This definition is for the 
 sake of memory usage on the APEG bind operation, that migth require toe keep the whole input 
 as the recognized input. </p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Input" class="def">Input</a> = String <a href="src/APEG.State.html#Input" class="link">Source</a> <a href="#t:Input" class="selflink">#</a></p><div class="doc"><p>The recognizer input is represented by an String.</p></div></div><div class="top"><p class="src"><a id="v:rVal" class="def">rVal</a> :: a -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> a <a href="src/APEG.State.html#rVal" class="link">Source</a> <a href="#v:rVal" class="selflink">#</a></p><div class="doc"><p>Builds a success Result from a particular value.</p></div></div><div class="top"><p class="src"><a id="v:rErr" class="def">rErr</a> :: String -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> a <a href="src/APEG.State.html#rErr" class="link">Source</a> <a href="#v:rErr" class="selflink">#</a></p><div class="doc"><p>Builds a failure Result from an error message.</p></div></div><div class="top"><p class="src"><a id="v:-63-:" class="def">(?:)</a> :: Char -&gt; <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a> -&gt; <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a> <a href="src/APEG.State.html#%3F%3A" class="link">Source</a> <a href="#v:-63-:" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:nullTraceStr" class="def">nullTraceStr</a> :: <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a> <a href="src/APEG.State.html#nullTraceStr" class="link">Source</a> <a href="#v:nullTraceStr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:emptyTraceStr" class="def">emptyTraceStr</a> :: <a href="APEG-State.html#t:TraceStr" title="APEG.State">TraceStr</a> <a href="src/APEG.State.html#emptyTraceStr" class="link">Source</a> <a href="#v:emptyTraceStr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:errorTuple" class="def">errorTuple</a> :: String -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a <a href="src/APEG.State.html#errorTuple" class="link">Source</a> <a href="#v:errorTuple" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isOkTuple" class="def">isOkTuple</a> :: <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; Bool <a href="src/APEG.State.html#isOkTuple" class="link">Source</a> <a href="#v:isOkTuple" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:valEnv" class="def">valEnv</a> :: <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a> <a href="src/APEG.State.html#valEnv" class="link">Source</a> <a href="#v:valEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:tyEnv" class="def">tyEnv</a> :: <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a> <a href="src/APEG.State.html#tyEnv" class="link">Source</a> <a href="#v:tyEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:upValEnv" class="def">upValEnv</a> :: (<a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a> -&gt; <a href="APEG-State.html#t:VEnv" title="APEG.State">VEnv</a>) -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a <a href="src/APEG.State.html#upValEnv" class="link">Source</a> <a href="#v:upValEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:upTyEnv" class="def">upTyEnv</a> :: (<a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a> -&gt; <a href="APEG-State.html#t:TyEnv" title="APEG.State">TyEnv</a>) -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a <a href="src/APEG.State.html#upTyEnv" class="link">Source</a> <a href="#v:upTyEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:withResult" class="def">withResult</a> :: ([String] -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> b) -&gt; (a -&gt; <a href="APEG-State.html#t:Result" title="APEG.State">Result</a> b) -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> a -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> b <a href="src/APEG.State.html#withResult" class="link">Source</a> <a href="#v:withResult" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:valIsMExpr" class="def">valIsMExpr</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; Bool <a href="src/APEG.State.html#valIsMExpr" class="link">Source</a> <a href="#v:valIsMExpr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:valIsMPeg" class="def">valIsMPeg</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; Bool <a href="src/APEG.State.html#valIsMPeg" class="link">Source</a> <a href="#v:valIsMPeg" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:strVal" class="def">strVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; String <a href="src/APEG.State.html#strVal" class="link">Source</a> <a href="#v:strVal" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:expFromVal" class="def">expFromVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; <a href="APEG-AbstractSyntax.html#t:Expr" title="APEG.AbstractSyntax">Expr</a> <a href="src/APEG.State.html#expFromVal" class="link">Source</a> <a href="#v:expFromVal" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:varNameFromVal" class="def">varNameFromVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; <a href="APEG-AbstractSyntax.html#t:Var" title="APEG.AbstractSyntax">Var</a> <a href="src/APEG.State.html#varNameFromVal" class="link">Source</a> <a href="#v:varNameFromVal" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:apegFromVal" class="def">apegFromVal</a> :: <a href="APEG-AbstractSyntax.html#t:Value" title="APEG.AbstractSyntax">Value</a> -&gt; <a href="APEG-AbstractSyntax.html#t:APeg" title="APEG.AbstractSyntax">APeg</a> <a href="src/APEG.State.html#apegFromVal" class="link">Source</a> <a href="#v:apegFromVal" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:zeroSt" class="def">zeroSt</a> :: <a href="APEG-AbstractSyntax.html#t:ApegGrm" title="APEG.AbstractSyntax">ApegGrm</a> -&gt; String -&gt; <a href="APEG-State.html#t:APegTuple" title="APEG.State">APegTuple</a> () <a href="src/APEG.State.html#zeroSt" class="link">Source</a> <a href="#v:zeroSt" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:ruleEntry" class="def">ruleEntry</a> :: <a href="APEG-AbstractSyntax.html#t:ApegRule" title="APEG.AbstractSyntax">ApegRule</a> -&gt; (<a href="APEG-AbstractSyntax.html#t:NonTerminal" title="APEG.AbstractSyntax">NonTerminal</a>, (<a href="APEG-AbstractSyntax.html#t:Type" title="APEG.AbstractSyntax">Type</a>, <a href="APEG-State.html#t:TyRuleEnv" title="APEG.State">TyRuleEnv</a>)) <a href="src/APEG.State.html#ruleEntry" class="link">Source</a> <a href="#v:ruleEntry" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isOk" class="def">isOk</a> :: <a href="APEG-State.html#t:APegSt" title="APEG.State">APegSt</a> () Bool <a href="src/APEG.State.html#isOk" class="link">Source</a> <a href="#v:isOk" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.20.0</p></div></body></html>